[phases.setup]
nixPkgs = ["nodejs_20"]

[phases.install]
cmds = ["node -e \"const p=JSON.parse(require('fs').readFileSync('package.json','utf8'));if(p.dependencies)delete p.dependencies['@titan/forge'];require('fs').writeFileSync('package.json',JSON.stringify(p,null,2))\" && npm ci --include=dev"]

[phases.build]
cmds = ["npm run build"]

[start]
cmd = "node .next/standalone/apps/web/server.js"
